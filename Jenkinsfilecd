pipeline {
    agent any 
    stages {
        stage('Push to docker hub') {
            steps {
                script {
                   withCredentials([string(credentialsId: 'dockerhub', variable: 'dockerhubpasswd')]){
                        sh "docker login -u sreejitheyne -p ${dockerhubpasswd}"
                    }
                        sh 'docker push sreejitheyne/openjdk:17.0.2'
                }
            }
        }
        stage('Kubernetes Deployment') {
            steps {
                script {
                      sh "kubectl apply -f /var/lib/jenkins/workspace/javaqr_cd/deployment.YAML"

                }
                
            }
        }

    }

 }
